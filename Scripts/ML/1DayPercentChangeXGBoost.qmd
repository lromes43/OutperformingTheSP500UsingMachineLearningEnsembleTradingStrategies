---
title: "Untitled"
format: html
---


```{python}
import pandas as pd 
import numpy as np   
from plotnine import *  
import xgboost as xgb 
from sklearn.model_selection import StratifiedShuffleSplit
from sklearn.impute import SimpleImputer
from sklearn.metrics import (
    accuracy_score, log_loss, roc_auc_score, confusion_matrix, classification_report, ConfusionMatrixDisplay, f1_score
)
from sklearn.model_selection import ParameterGrid
from tqdm import tqdm 
import matplotlib.pyplot as plt
import shap
from sklearn.metrics import roc_curve, roc_auc_score
from sklearn.preprocessing import StandardScaler
```


```{python}
train = pd.read_feather("/Users/lukeromes/Desktop/Personal/Sp500Project/Data/TrainData.feather")
test = pd.read_feather("/Users/lukeromes/Desktop/Personal/Sp500Project/Data/TestData.feather")
```

Want to predict one day return % so use Day_to_Day_Percent_Diff which is the % change day to day

Need to change data a little first though. 



```{python}
X_train_raw = train.drop(['Date', 'Day_to_Day_Diff', 'Day_to_Day_Percent_Diff', 'Five_Day_Percent_Diff', 'Two_Week_Percent_Diff', 'Monthly_Percent_Diff', 'Daily_Return', 'Day_Range', 'Movement', 'Five_Day_Movement'], axis = 1)

X_test_raw = test.drop(['Date', 'Day_to_Day_Diff', 'Day_to_Day_Percent_Diff', 'Five_Day_Percent_Diff', 'Two_Week_Percent_Diff', 'Monthly_Percent_Diff', 'Daily_Return', 'Day_Range', 'Movement', 'Five_Day_Movement'], axis = 1)

X_train_raw = pd.get_dummies(X_train_raw, drop_first=True)
X_test_raw = pd.get_dummies(X_test_raw, drop_first=True)


X_train_final = X_train_raw.apply(pd.to_numeric, errors = 'coerce')
X_test_final = X_test_raw.apply(pd.to_numeric, errors = 'coerce')

y_train_final = pd.Categorical(train['Five_Day_Movement'])
y_test_final = pd.Categorical(test['Five_Day_Movement'])
dtrain = xgb.DMatrix(data = X_train_final, label = y_train_final)
dtest = xgb.DMatrix(data = X_test_final, label = y_test_final)
```